improving the style
... error handling
... reduce repetion
revise some crap
